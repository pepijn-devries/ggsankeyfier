% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geom_segment.r, R/geom_edge.r
\docType{data}
\name{GeomSankeysegment}
\alias{GeomSankeysegment}
\alias{geom_sankeysegment}
\alias{GeomSankeyedge}
\alias{geom_sankeyedge}
\title{Sankey edges (flows)}
\format{
An object of class \code{GeomSankeysegment} (inherits from \code{GeomSegment}, \code{Geom}, \code{ggproto}, \code{gg}) of length 4.

An object of class \code{GeomSankeyedge} (inherits from \code{GeomSankeysegment}, \code{GeomSegment}, \code{Geom}, \code{ggproto}, \code{gg}) of length 7.
}
\usage{
GeomSankeysegment

geom_sankeysegment(
  mapping = NULL,
  data = NULL,
  stat = "sankeyedge",
  position = "sankey",
  na.rm = FALSE,
  show.legend = NA,
  order = c("ascending", "descending", "as_is"),
  width = "auto",
  align = c("bottom", "top", "center", "justify"),
  h_space = "auto",
  v_space = 0,
  nudge_x = 0,
  nudge_y = 0,
  split_nodes = FALSE,
  split_tol = 0.001,
  direction = c("forward", "backward"),
  inherit.aes = TRUE,
  ...
)

GeomSankeyedge

geom_sankeyedge(
  mapping = NULL,
  data = NULL,
  stat = "sankeyedge",
  position = "sankey",
  na.rm = FALSE,
  show.legend = NA,
  slope = 0.5,
  ncp = 100,
  width = "auto",
  align = c("bottom", "top", "center", "justify"),
  order = c("ascending", "descending", "as_is"),
  h_space = "auto",
  v_space = 0,
  nudge_x = 0,
  nudge_y = 0,
  split_nodes = FALSE,
  split_tol = 0.001,
  direction = c("forward", "backward"),
  inherit.aes = TRUE,
  ...
)
}
\arguments{
\item{mapping}{Set of aesthetic mappings created by \code{\link[ggplot2:aes]{aes()}}. If specified and
\code{inherit.aes = TRUE} (the default), it is combined with the default mapping
at the top level of the plot. You must supply \code{mapping} if there is no plot
mapping.}

\item{data}{The data to be displayed in this layer. There are three
options:

If \code{NULL}, the default, the data is inherited from the plot
data as specified in the call to \code{\link[ggplot2:ggplot]{ggplot()}}.

A \code{data.frame}, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
\code{\link[ggplot2:fortify]{fortify()}} for which variables will be created.

A \code{function} will be called with a single argument,
the plot data. The return value must be a \code{data.frame}, and
will be used as the layer data. A \code{function} can be created
from a \code{formula} (e.g. \code{~ head(.x, 10)}).}

\item{stat}{The statistical transformation to use on the data for this layer.
When using a \verb{geom_*()} function to construct a layer, the \code{stat}
argument can be used the override the default coupling between geoms and
stats. The \code{stat} argument accepts the following:
\itemize{
\item A \code{Stat} ggproto subclass, for example \code{StatCount}.
\item A string naming the stat. To give the stat as a string, strip the
function name of the \code{stat_} prefix. For example, to use \code{stat_count()},
give the stat as \code{"count"}.
\item For more information and other ways to specify the stat, see the
\link[ggplot2:layer_stats]{layer stat} documentation.
}}

\item{position}{A position adjustment to use on the data for this layer. This
can be used in various ways, including to prevent overplotting and
improving the display. The \code{position} argument accepts the following:
\itemize{
\item The result of calling a position function, such as \code{position_jitter()}.
This method allows for passing extra arguments to the position.
\item A string naming the position adjustment. To give the position as a
string, strip the function name of the \code{position_} prefix. For example,
to use \code{position_jitter()}, give the position as \code{"jitter"}.
\item For more information and other ways to specify the position, see the
\link[ggplot2:layer_positions]{layer position} documentation.
}}

\item{na.rm}{If \code{FALSE}, the default, missing values are removed with
a warning. If \code{TRUE}, missing values are silently removed.}

\item{show.legend}{logical. Should this layer be included in the legends?
\code{NA}, the default, includes if any aesthetics are mapped.
\code{FALSE} never includes, and \code{TRUE} always includes.
It can also be a named logical vector to finely select the aesthetics to
display.}

\item{order}{A \code{character} indicating the method to be used for the order of stacking
nodes and edges in a plot.
Should be one of: \code{ascending} (default), sorts nodes and edges from large to small
(largest on top); \code{descending} sorts nodes and edges from small to large (smallest
on top); \code{as_is} will leave the order of nodes and edges as they are in \code{data}.}

\item{width}{Width of the node (\code{numeric}). When \code{split_nodes} is set to \code{TRUE}
each part of the split node will have half this width. Use \code{"auto"} to automatically
determine a suitable width.}

\item{align}{A \code{character} that indicates how the nodes across the stages are aligned.
It can be any of \code{"top"}, \code{"bottom"}, \code{"center"} or \code{"justify"}.}

\item{h_space}{Horizontal space between split nodes (\code{numeric}). This argument is
ignored when \code{split_nodes == FALSE}. Use \code{"auto"} to automatically position split nodes.}

\item{v_space}{Vertical space between nodes (\code{numeric}). When set to zero (\code{0}),
the Sankey diagram becomes an alluvial plot. Use \code{"auto"} to automatically determine
a suitable vertical space.}

\item{nudge_x, nudge_y}{Horizontal and vertical adjustment to nudge items by. Can
be useful for offsetting labels.}

\item{split_nodes}{A \code{logical} value indicating whether the source and destination nodes
should be depicted as separate boxes.}

\item{split_tol}{When the relative node size (resulting source and destination edges)
differs more than this fraction, the node will be displayed as two separate bars.}

\item{direction}{One of \code{"forward"} (default) or \code{"backward"}. When set to \code{"backward"}
the direction of the edges will be inverted. In most cases this
parameter won't affect the plot. It can be helpful when you want to decorate the
end of an edge (instead of the start; see examples).}

\item{inherit.aes}{If \code{FALSE}, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. \code{\link[ggplot2:borders]{borders()}}.}

\item{...}{Other arguments passed on to \code{\link[ggplot2:layer]{layer()}}'s \code{params} argument. These
arguments broadly fall into one of 4 categories below. Notably, further
arguments to the \code{position} argument, or aesthetics that are required
can \emph{not} be passed through \code{...}. Unknown arguments that are not part
of the 4 categories below are ignored.
\itemize{
\item Static aesthetics that are not mapped to a scale, but are at a fixed
value and apply to the layer as a whole. For example, \code{colour = "red"}
or \code{linewidth = 3}. The geom's documentation has an \strong{Aesthetics}
section that lists the available options. The 'required' aesthetics
cannot be passed on to the \code{params}. Please note that while passing
unmapped aesthetics as vectors is technically possible, the order and
required length is not guaranteed to be parallel to the input data.
\item When constructing a layer using
a \verb{stat_*()} function, the \code{...} argument can be used to pass on
parameters to the \code{geom} part of the layer. An example of this is
\code{stat_density(geom = "area", outline.type = "both")}. The geom's
documentation lists which parameters it can accept.
\item Inversely, when constructing a layer using a
\verb{geom_*()} function, the \code{...} argument can be used to pass on parameters
to the \code{stat} part of the layer. An example of this is
\code{geom_area(stat = "density", adjust = 0.5)}. The stat's documentation
lists which parameters it can accept.
\item The \code{key_glyph} argument of \code{\link[ggplot2:layer]{layer()}} may also be passed on through
\code{...}. This can be one of the functions described as
\link[ggplot2:draw_key]{key glyphs}, to change the display of the layer in the legend.
}}

\item{slope}{Slope parameter (\code{numeric}) for the Bezier curves used to depict the edges.
Any value between 0 and 1 will work nicely. Other non-zero values will also work.}

\item{ncp}{Number of control points on the Bezier curve that forms the edge. Larger
numbers will result in smoother curves, but cost more computational time. Default is
100.}
}
\value{
Returns a \code{\link[ggplot2:layer]{ggplot2::layer()}} which can be added to a \code{\link[ggplot2:ggplot]{ggplot2::ggplot()}}
}
\description{
\code{geom_sankeysegment()} draws a straight line between two connected nodes,
\code{geom_sankeyedge()} draws a ribbon between nodes following a Bezier curved path.
If you combine the edges with \code{\link[=geom_sankeynode]{geom_sankeynode()}}, make sure that both use the
same \code{position} object.
}
\details{
This \code{ggplot2} layer connects between paired nodes via a Bezier curve. The width
of the curve is determined by its \code{y} aesthetic. It will be attempted to keep the
width of the curve constant along its curved path, for the targeted graphics device.
When the aspect ratio of the graphics device is altered after the plot is generated,
the aspect ratio maybe off. In that case render the plot again.
}
\section{Aesthetics}{

\code{geom_sankeysegment()} and \code{geom_sankeyedge()} understand the following
aesthetics (required aesthetics are in bold)



\if{html}{\figure{important_aspects.svg}{Important aspects}}
\itemize{
\item \strong{\code{x}}: Works for variables on a discrete scale. Might work for continuous variables
but is not guaranteed. This variable is used to distinguish between stages in the
Sankey diagram on the x axis.
\item \strong{\code{y}}: A continuous variable representing the width of the edges in a Sankey
diagram.
\item \strong{\code{group}}: A discrete variable used for grouping edges to nodes in each stage.
Essentially it is an identifier for the nodes.
\item \strong{\code{connector}}: Indicates which side of an edge is reflected by the corresponding
record. Should be one of \code{"from"} or \code{"to"}.
\item \strong{\code{edge_id}}: A unique identifier value for each edge. This identifier is used
to link specific \code{"from"} and \code{"to"} records in an edge (flow).
\item fill: see \code{vignette("ggplot2-specs", "ggplot2")}
\item colour: see \code{vignette("ggplot2-specs", "ggplot2")}
\item linetype: see \code{vignette("ggplot2-specs", "ggplot2")}
\item linewidth: see \code{vignette("ggplot2-specs", "ggplot2")}
\item alpha: A variable to control the opacity of an element.
}


\itemize{
\item waist: A variable to control the width of an edge in between
two nodes. Small values will create a hour glass shape, whereas large values will
produce an apple shape.
}
}

\examples{
library(ggplot2)
data("ecosystem_services")

ggplot(ecosystem_services_pivot1, aes(x = stage, y = RCSES, group = node,
                    connector = connector, edge_id = edge_id,
                    fill = node)) +
  geom_sankeynode(v_space = "auto") +
  geom_sankeyedge(v_space = "auto")
}
\author{
Pepijn de Vries
}
\keyword{datasets}
