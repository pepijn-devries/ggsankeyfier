<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Create Sankey and Alluvial Diagrams Using ggplot2 • ggsankeyfier</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Create Sankey and Alluvial Diagrams Using ggplot2">
<meta name="description" content="Sankey and alluvial diagrams visualise flows of quantities across stages in stacked bars. This package makes it easy to create such diagrams using ggplot2.">
<meta property="og:description" content="Sankey and alluvial diagrams visualise flows of quantities across stages in stacked bars. This package makes it easy to create such diagrams using ggplot2.">
<meta property="og:image" content="https://pepijn-devries.github.io/ggsankeyfier/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ggsankeyfier</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.8.0003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/data_management.html">Sankey data management</a></li>
    <li><a class="dropdown-item" href="articles/decorating.html">Decorating Sankey diagrams</a></li>
    <li><a class="dropdown-item" href="articles/loopdeloop.html">Loop De Loop</a></li>
    <li><a class="dropdown-item" href="articles/positioning.html">Positioning Sankey elements</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pepijn-devries/ggsankeyfier/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><blockquote>
<p><code>ggsankeyfier</code> Go with the data flow</p>
</blockquote>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<!-- badges: start -->

<p><img src="reference/figures/logo.png" align="right" alt="logo"></p>
<p>The <code>ggsankeyfier</code> packages allows you to visualise your data as Sankey or Alluvial diagrams. A Sankey diagram is essentially a stacked bar plot, where the bands connect bars across stages (on the x-axis), to show how quantities flow between them.</p>
</div>
<div class="section level2">
<h2 id="why-use-ggsankeyfier">Why use <code>ggsankeyfier</code>?<a class="anchor" aria-label="anchor" href="#why-use-ggsankeyfier"></a>
</h2>
<p><code>ggsankeyfier</code> allows you to add Sankey diagram layers to a <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code>. The package also provides <code>stat_*</code> and <code>position_*</code> functions that allow you to add all sorts of other layers, such as text and labels.</p>
<p>Furthermore, the data model used by the package allows you to visualise flows that skip stages or even feedback loops.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<blockquote>
<p>Get CRAN version</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ggsankeyfier"</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Get development version on github</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">'pepijn-devries/ggsankeyfier'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="important-concepts">Important concepts<a class="anchor" aria-label="anchor" href="#important-concepts"></a>
</h2>
<p>As there is some variation in the definition and terminology used in Sankey diagrams, there are some introduced here for consistency across the package documentation. Here we try to adhere to common definitions used in the <a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link">graph theory</a>. This theory is used to model pairwise relationships between ‘nodes’ which are connected by ‘edges’. These aspects are circled in the illustration below.</p>
<figure><img src="reference/figures/important_aspects.svg" alt="Important aspects"><figcaption aria-hidden="true">
Important aspects
</figcaption></figure><p>The <code>ggsankeyfier</code> package can only visualise structured graphs. Meaning that each node belongs to a specific stage (arranged along the x-axis).</p>
<div class="section level3">
<h3 id="sankey-thesaurus">Sankey thesaurus<a class="anchor" aria-label="anchor" href="#sankey-thesaurus"></a>
</h3>
<p>As there are no standards in Sankey diagrams, there may be different words representing the same or similar aspects. Therefore the following thesaurus is presented to provide an overview and hopefully avoid confusion. The list starts with the term preferred in the present package, followed by alternatives.</p>
<ul>
<li>Sankey diagram:
<ul>
<li>
<em>Alluvial diagram</em>. Although arguably not the same as a Sankey diagram, they are very similar. Differences ly in the type of data (population of facts across categorical dimensions (alluvial) versus quantities in different states (Sankey)) Also, alluvial diagrams are always structured in stages (where the order does not matter), whereas Sankey diagrams are not necessarily structured, but the order does matter <!-- See also  http://www.datasmith.org/2020/05/02/alluvial-plots-vs-sankey-diagrams and
    https://datavizcatalogue.com/blog/sankey-diagrams-parallel-sets-alluvial-diagrams-whats-the-difference/ -->
</li>
<li>
<em>Bump diagram</em>. This is actually a special case of alluvial diagrams, where each node flows only to a single next node. Usually, the stacking order of nodes in each stage is determined by the size of the nodes</li>
</ul>
</li>
<li>Node:
<ul>
<li>
<em>Vertices</em>. Another commonly used term in the <a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link">graph theory</a>
</li>
<li>
<em>Stratum</em>. A term coined for alluvial diagrams</li>
</ul>
</li>
<li>Edge:
<ul>
<li>
<em>Flow</em>. Sometimes also refers to the interaction between stages. In the present package it is used only as a synonym for ‘edge’.</li>
<li>
<em>Alluvium</em>. A term used in alluvial diagrams</li>
<li>
<em>Line</em>. Another commonly used albeit generic term in the <a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link">graph theory</a>
</li>
<li>
<em>Link</em>. Although commonly used in the <a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link">graph theory</a>, we avoid its use in this context as it may get confused with a link in a cause-effect chain, which is better reflected by the stages</li>
</ul>
</li>
<li>Connector:
<ul>
<li>
<em>Lode</em>. A term used in alluvial diagrams</li>
</ul>
</li>
<li>Stage:
<ul>
<li>
<em>Link</em>. Not used in the present package to avoid confusion with edges (see above)</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Like any other ggplot, you start by calling <code><a href="https://ggplot2.tidyverse.org/reference/ggplot2-package.html" class="external-link">ggplot2::ggplot2()</a></code>, provide the data for plotting and specify aesthetics (<code>aes</code>). Layers with Sankey edges and nodes are simply added to the plot using the <code>+</code>-operator:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ecosystem_services"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ecosystem_services_pivot1</span>,</span>
<span>       <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">stage</span>, y <span class="op">=</span> <span class="va">RCSES</span>, group <span class="op">=</span> <span class="va">node</span>,</span>
<span>           connector <span class="op">=</span> <span class="va">connector</span>, edge_id <span class="op">=</span> <span class="va">edge_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_sankeyedge.html">geom_sankeyedge</a></span><span class="op">(</span>v_space <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_sankeynode.html">geom_sankeynode</a></span><span class="op">(</span>v_space <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-general_illustration-1.svg"><!-- --></p>
<p>For consistency with aesthetics used in other <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> layers, the stage variable should be assigned to <code>x</code>, the quantity of the nodes and edges to <code>y</code> and the node identifier to <code>group</code>. In addition to these ‘standard’ aesthetics, you also need to specify a <code>connector</code> specifying the direction of an edge (one of <code>'from'</code> or <code>'to'</code>); and an <code>edge_id</code> which is used to determine which connector ends should be paired together.</p>
<div class="section level3">
<h3 id="data-management">Data management<a class="anchor" aria-label="anchor" href="#data-management"></a>
</h3>
<p>Note that the plotting routines require data organised in a <code>data.frame</code>, with in each row a ‘connector’. A connector is either the start or an end of an edge. This allows you to provide different characteristics for each of these ends. However, in most cases this is not the type of data you will be working with. Check <code><a href="articles/data_management.html">vignette("data_management")</a></code>, on how to rearrange your data for displaying it in a Sankey diagram.</p>
</div>
<div class="section level3">
<h3 id="positioning-nodes-and-edges">Positioning nodes and edges<a class="anchor" aria-label="anchor" href="#positioning-nodes-and-edges"></a>
</h3>
<p>The package gives you much control on the positioning of elements in the diagram. Think of:</p>
<ul>
<li>spacing between and sizing of nodes and edges</li>
<li>aligning nodes vertically</li>
<li>introducing a horizontal split in nodes</li>
<li>stacking order of nodes and edges</li>
</ul>
<p><code><a href="articles/positioning.html">vignette("positioning")</a></code> will show you how.</p>
</div>
<div class="section level3">
<h3 id="decorating-nodes-and-edges">Decorating nodes and edges<a class="anchor" aria-label="anchor" href="#decorating-nodes-and-edges"></a>
</h3>
<p>When creating your own Sankey diagrams you may want to alter its appearance. You may want to:</p>
<ul>
<li>assign meaningful decorations (such as colours) using aesthetics to nodes and edges</li>
<li>add keys and legends to guide your audience</li>
<li>add additional layers (such as text)</li>
<li>change the edge curve shape</li>
<li>use different themes</li>
</ul>
<p>Check <code><a href="articles/decorating.html">vignette("decorating")</a></code> to discover how this is done.</p>
</div>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <code>ggsankeyfier</code> project is released with a <a href="https://contributor-covenant.org/version/2/1/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<p>This package was development as part of the EU GES4SEAS project (EU call HORIZON-CL6-2021-BIODIV-01-04, grant agreement <a href="https://doi.org/10.3030/101059877" class="external-link">101059877</a>) and the WUR Knowledge Base Research program KB-36-003-022 “The use of ecosystem services to conserve biodiversity in the North Sea” that is supported by finance from the Dutch Ministry of Agriculture, Nature and Food Quality</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<ul>
<li>Piet GJ, Jongbloed RH, Bentley JW, Grundlehner A, Tamis JE, De Vries P (<em>in prep.</em>) A Cumulative Impact Assessment on the North Sea Capacity to Supply Ecosystem Services <a href="http://dx.doi.org/10.2139/ssrn.4760674" class="external-link">DOI:10.2139/ssrn.4760674</a>
</li>
</ul>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ggsankeyfier" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/pepijn-devries/ggsankeyfier/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/pepijn-devries/ggsankeyfier/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ggsankeyfier</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pepijn de Vries <br><small class="roles"> Author, maintainer, data contributor </small> <a href="https://orcid.org/0000-0002-7961-6646" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/pepijn-devries/csquares/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/pepijn-devries/ggsankeyfier/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://CRAN.R-project.org/package=ggsankeyfier" class="external-link"><img src="https://www.r-pkg.org/badges/version/ggsankeyfier" alt="version"></a></li>
<li><a href="https://cran.r-project.org/web/checks/check_results_ggsankeyfier.html" class="external-link"><img src="https://badges.cranchecks.info/worst/ggsankeyfier.svg" alt="cran checks"></a></li>
<li><a href="https://pepijn-devries.r-universe.dev/ggsankeyfier" class="external-link"><img src="https://pepijn-devries.r-universe.dev/badges/ggsankeyfier" alt="csquares status badge"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pepijn de Vries.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
